<!-- HTML generated using hilite.me --><div style="background: #202020; overflow:auto;width:auto;padding:.2em .6em;"><pre style="background: #202020; margin: 0; line-height: 125%">
<span style="color: #6ab825; font-weight: bold">private</span> <span style="color: #6ab825; font-weight: bold">function</span> <span style="color: #447fcf">deathCheck</span><span style="color: #d0d0d0">(&amp;</span><span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">)</span>  <span style="color: #d0d0d0">{</span>
	<span style="color: #40ffff">$a</span><span style="color: #d0d0d0">=</span><span style="color: #3677a9">2.2765E-06</span><span style="color: #d0d0d0">;</span>
	<span style="color: #40ffff">$b</span><span style="color: #d0d0d0">=-</span><span style="color: #3677a9">0.00040584</span><span style="color: #d0d0d0">;</span>
	<span style="color: #40ffff">$c</span><span style="color: #d0d0d0">=</span><span style="color: #3677a9">0.022322</span><span style="color: #d0d0d0">;</span>
	<span style="color: #40ffff">$d</span><span style="color: #d0d0d0">=-</span><span style="color: #3677a9">0.37058</span><span style="color: #d0d0d0">;</span>
	<span style="color: #40ffff">$f</span><span style="color: #d0d0d0">=</span><span style="color: #3677a9">1.377</span><span style="color: #d0d0d0">;</span>
	<span style="color: #40ffff">$x</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">(</span><span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">age</span><span style="color: #d0d0d0">*</span><span style="color: #3677a9">100</span><span style="color: #d0d0d0">)/</span><span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">race</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">maxAge</span><span style="color: #d0d0d0">;</span>

	<span style="color: #40ffff">$deathChance</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">max(</span><span style="color: #40ffff">$a</span><span style="color: #d0d0d0">*pow(</span><span style="color: #40ffff">$x</span><span style="color: #d0d0d0">,</span><span style="color: #3677a9">4</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">+</span> <span style="color: #40ffff">$b</span><span style="color: #d0d0d0">*pow(</span><span style="color: #40ffff">$x</span><span style="color: #d0d0d0">,</span><span style="color: #3677a9">3</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">+</span> <span style="color: #40ffff">$c</span><span style="color: #d0d0d0">*pow(</span><span style="color: #40ffff">$x</span><span style="color: #d0d0d0">,</span><span style="color: #3677a9">2</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">+</span> <span style="color: #40ffff">$d</span><span style="color: #d0d0d0">*</span><span style="color: #40ffff">$x</span> <span style="color: #d0d0d0">+</span> <span style="color: #40ffff">$f</span><span style="color: #d0d0d0">,</span><span style="color: #3677a9">0.1</span><span style="color: #d0d0d0">)*</span><span style="color: #3677a9">10</span><span style="color: #d0d0d0">;</span>
	<span style="color: #40ffff">$preSQL</span> <span style="color: #d0d0d0">=</span> <span style="color: #ed9d13">&quot;UPDATE citizen SET&quot;</span><span style="color: #d0d0d0">;</span>
	<span style="color: #6ab825; font-weight: bold">if</span> <span style="color: #d0d0d0">((mt_rand(</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">,</span><span style="color: #3677a9">1000</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">&lt;</span> <span style="color: #40ffff">$deathChance</span> <span style="color: #d0d0d0">||</span> <span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">age</span> <span style="color: #d0d0d0">&gt;=</span> <span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">race</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">maxAge</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">&amp;&amp;</span> <span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">immortal</span> <span style="color: #d0d0d0">!=</span> <span style="color: #3677a9">1</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">{</span>
	    <span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">racialBalance</span><span style="color: #d0d0d0">[</span><span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">race</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">name</span><span style="color: #d0d0d0">]--;</span>
        <span style="color: #40ffff">$racialBalance</span> <span style="color: #d0d0d0">=</span> <span style="color: #6ab825; font-weight: bold">null</span><span style="color: #d0d0d0">;</span>
        <span style="color: #6ab825; font-weight: bold">foreach</span><span style="color: #d0d0d0">(</span><span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">region</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">racialBalance</span> <span style="color: #6ab825; font-weight: bold">as</span> <span style="color: #40ffff">$key</span><span style="color: #d0d0d0">=&gt;</span><span style="color: #40ffff">$race</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">{</span><span style="color: #6ab825; font-weight: bold">if</span> <span style="color: #d0d0d0">(</span><span style="color: #40ffff">$key</span> <span style="color: #d0d0d0">==</span> <span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">race</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">id</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">{</span>
        	<span style="color: #40ffff">$racialBalance</span> <span style="color: #d0d0d0">=</span> <span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">region</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">racialBalance</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #40ffff">$key</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">value</span><span style="color: #d0d0d0">;</span>
        <span style="color: #d0d0d0">}</span>

        <span style="color: #6ab825; font-weight: bold">if</span> <span style="color: #d0d0d0">(</span><span style="color: #40ffff">$racialBalance</span> <span style="color: #d0d0d0">!=</span> <span style="color: #6ab825; font-weight: bold">null</span> <span style="color: #d0d0d0">&amp;&amp;</span> <span style="color: #40ffff">$racialBalance</span> <span style="color: #d0d0d0">&gt;</span> <span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">racialBalance</span><span style="color: #d0d0d0">[</span><span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">race</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">name</span><span style="color: #d0d0d0">])</span> <span style="color: #d0d0d0">{</span>
	        <span style="color: #6ab825; font-weight: bold">if</span> <span style="color: #d0d0d0">(mt_rand(</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">,</span><span style="color: #3677a9">100</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">&lt;</span> <span style="color: #3677a9">50</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">{</span>
	        	<span style="color: #40ffff">$transplantGender</span> <span style="color: #d0d0d0">=</span> <span style="color: #ed9d13">&quot;male&quot;</span><span style="color: #d0d0d0">;</span>
	        <span style="color: #d0d0d0">}</span> <span style="color: #6ab825; font-weight: bold">else</span> <span style="color: #d0d0d0">{</span>
	        	<span style="color: #40ffff">$transplantGender</span> <span style="color: #d0d0d0">=</span> <span style="color: #ed9d13">&quot;female&quot;</span><span style="color: #d0d0d0">;</span>
	        <span style="color: #d0d0d0">}</span>
            <span style="color: #40ffff">$transplant</span> <span style="color: #d0d0d0">=</span> <span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">newCitizen</span><span style="color: #d0d0d0">(mt_rand(</span><span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">race</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">adulthood</span><span style="color: #d0d0d0">,</span><span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">race</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">adulthood</span><span style="color: #d0d0d0">*</span><span style="color: #3677a9">2</span><span style="color: #d0d0d0">),</span> <span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">race</span><span style="color: #d0d0d0">,</span> <span style="color: #40ffff">$transplantGender</span><span style="color: #d0d0d0">,</span> <span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">generation</span><span style="color: #d0d0d0">);</span>
            <span style="color: #40ffff">$transplant</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">race</span> <span style="color: #d0d0d0">=</span> <span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">race</span><span style="color: #d0d0d0">;</span>
            <span style="color: #40ffff">$transplant</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">region</span> <span style="color: #d0d0d0">=</span> <span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">region</span><span style="color: #d0d0d0">;</span>
            <span style="color: #40ffff">$transplant</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">children</span> <span style="color: #d0d0d0">=</span> <span style="color: #24909d">explode</span><span style="color: #d0d0d0">(</span><span style="color: #ed9d13">&quot;,&quot;</span><span style="color: #d0d0d0">,</span><span style="color: #40ffff">$transplant</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">children</span><span style="color: #d0d0d0">);</span>
            <span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">citizens</span><span style="color: #d0d0d0">[</span><span style="color: #40ffff">$transplant</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">id</span><span style="color: #d0d0d0">]</span> <span style="color: #d0d0d0">=</span> <span style="color: #40ffff">$transplant</span><span style="color: #d0d0d0">;</span>
		    <span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">racialBalance</span><span style="color: #d0d0d0">[</span><span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">race</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">name</span><span style="color: #d0d0d0">]++;</span>
        <span style="color: #d0d0d0">}</span>
   	    <span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">alive</span><span style="color: #d0d0d0">=</span><span style="color: #3677a9">0</span><span style="color: #d0d0d0">;</span>
		<span style="color: #40ffff">$note</span> <span style="color: #d0d0d0">=</span> <span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">notes</span><span style="color: #d0d0d0">.</span><span style="color: #ed9d13">&quot;Died in &quot;</span><span style="color: #d0d0d0">.</span><span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">region</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">epoch</span><span style="color: #d0d0d0">.</span><span style="color: #ed9d13">&quot; at &quot;</span><span style="color: #d0d0d0">.</span><span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">age</span><span style="color: #d0d0d0">.</span><span style="color: #ed9d13">&quot; years old \n&quot;</span><span style="color: #d0d0d0">;</span>
		<span style="color: #6ab825; font-weight: bold">if</span> <span style="color: #d0d0d0">(</span><span style="color: #24909d">gettype</span><span style="color: #d0d0d0">(</span><span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">spouse</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">==</span> <span style="color: #ed9d13">&quot;object&quot;</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">{</span>
			<span style="color: #40ffff">$note</span> <span style="color: #d0d0d0">=</span> <span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">spouse</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">notes</span><span style="color: #d0d0d0">.</span><span style="color: #ed9d13">&quot;Spouse died in &quot;</span><span style="color: #d0d0d0">.</span><span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">region</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">epoch</span><span style="color: #d0d0d0">.</span><span style="color: #ed9d13">&quot;\n&quot;</span><span style="color: #d0d0d0">;</span>
			<span style="color: #6ab825; font-weight: bold">if</span> <span style="color: #d0d0d0">(</span><span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">gender</span> <span style="color: #d0d0d0">==</span> <span style="color: #ed9d13">&#39;male&#39;</span> <span style="color: #d0d0d0">&amp;&amp;</span> <span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">spouse</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">age</span> <span style="color: #d0d0d0">&gt;</span> <span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">race</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">middleAge</span> <span style="color: #d0d0d0">&amp;&amp;</span> <span style="color: #d0d0d0">mt_rand(</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">,</span><span style="color: #3677a9">20</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">==</span> <span style="color: #3677a9">1</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">{</span>
				<span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">spouse</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">married</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">0</span><span style="color: #d0d0d0">;</span>
			<span style="color: #d0d0d0">}</span>
			<span style="color: #6ab825; font-weight: bold">if</span> <span style="color: #d0d0d0">(</span><span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">gender</span> <span style="color: #d0d0d0">==</span> <span style="color: #ed9d13">&#39;male&#39;</span> <span style="color: #d0d0d0">&amp;&amp;</span> <span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">spouse</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">age</span> <span style="color: #d0d0d0">&lt;</span> <span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">race</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">middleAge</span> <span style="color: #d0d0d0">&amp;&amp;</span> <span style="color: #d0d0d0">mt_rand(</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">,</span><span style="color: #3677a9">10</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">&lt;=</span> <span style="color: #3677a9">3</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">{</span>
				<span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">spouse</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">married</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">0</span><span style="color: #d0d0d0">;</span>
			<span style="color: #d0d0d0">}</span>
			<span style="color: #6ab825; font-weight: bold">if</span> <span style="color: #d0d0d0">(</span><span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">gender</span> <span style="color: #d0d0d0">==</span> <span style="color: #ed9d13">&#39;female&#39;</span> <span style="color: #d0d0d0">&amp;&amp;</span>  <span style="color: #d0d0d0">mt_rand(</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">,</span><span style="color: #3677a9">10</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">&lt;=</span> <span style="color: #3677a9">3</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">{</span>
				<span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">spouse</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">married</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">0</span><span style="color: #d0d0d0">;</span>
			<span style="color: #d0d0d0">}</span>

			<span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">spouse</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">notes</span> <span style="color: #d0d0d0">=</span> <span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">spouse</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">notes</span><span style="color: #d0d0d0">.</span><span style="color: #ed9d13">&quot;Spouse(&quot;</span><span style="color: #d0d0d0">.</span><span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">firstName</span><span style="color: #d0d0d0">.</span><span style="color: #ed9d13">&quot;) died in &quot;</span><span style="color: #d0d0d0">.</span><span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">region</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">epoch</span><span style="color: #d0d0d0">.</span><span style="color: #ed9d13">&quot;\n&quot;</span><span style="color: #d0d0d0">;</span>

		<span style="color: #d0d0d0">}</span>
		<span style="color: #6ab825; font-weight: bold">if</span> <span style="color: #d0d0d0">(!</span><span style="color: #24909d">is_array</span><span style="color: #d0d0d0">(</span><span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">children</span><span style="color: #d0d0d0">))</span> <span style="color: #d0d0d0">{</span>
			<span style="color: #6ab825; font-weight: bold">return</span><span style="color: #d0d0d0">;</span>
		<span style="color: #d0d0d0">}</span>
		<span style="color: #6ab825; font-weight: bold">if</span> <span style="color: #d0d0d0">(</span><span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">gender</span> <span style="color: #d0d0d0">==</span> <span style="color: #ed9d13">&quot;male&quot;</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">{</span>
			<span style="color: #40ffff">$parentGender</span> <span style="color: #d0d0d0">=</span> <span style="color: #ed9d13">&quot;Father&quot;</span><span style="color: #d0d0d0">;</span>
		<span style="color: #d0d0d0">}</span> <span style="color: #6ab825; font-weight: bold">else</span> <span style="color: #d0d0d0">{</span>
			<span style="color: #40ffff">$parentGender</span> <span style="color: #d0d0d0">=</span> <span style="color: #ed9d13">&quot;mother&quot;</span><span style="color: #d0d0d0">;</span>
		<span style="color: #d0d0d0">}</span>
		<span style="color: #6ab825; font-weight: bold">foreach</span><span style="color: #d0d0d0">(</span><span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">children</span> <span style="color: #6ab825; font-weight: bold">as</span> <span style="color: #40ffff">$child</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">{</span>
			<span style="color: #6ab825; font-weight: bold">if</span> <span style="color: #d0d0d0">(</span><span style="color: #40ffff">$child</span> <span style="color: #d0d0d0">==</span> <span style="color: #ed9d13">&quot;&quot;</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">{</span>
				<span style="color: #6ab825; font-weight: bold">continue</span><span style="color: #d0d0d0">;</span>
			<span style="color: #d0d0d0">}</span>
			<span style="color: #40ffff">$note</span> <span style="color: #d0d0d0">=</span> <span style="color: #40ffff">$parentGender</span><span style="color: #d0d0d0">.</span><span style="color: #ed9d13">&quot; died in &quot;</span><span style="color: #d0d0d0">.</span><span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">region</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">epoch</span><span style="color: #d0d0d0">.</span><span style="color: #ed9d13">&quot; when he/she was &quot;</span><span style="color: #d0d0d0">;</span>
			<span style="color: #6ab825; font-weight: bold">if</span> <span style="color: #d0d0d0">(</span><span style="color: #24909d">array_key_exists</span><span style="color: #d0d0d0">(</span><span style="color: #40ffff">$child</span><span style="color: #d0d0d0">,</span> <span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">citizens</span><span style="color: #d0d0d0">))</span> <span style="color: #d0d0d0">{</span>
				<span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">citizens</span><span style="color: #d0d0d0">[</span><span style="color: #40ffff">$child</span><span style="color: #d0d0d0">]-&gt;</span><span style="color: #bbbbbb">notes</span> <span style="color: #d0d0d0">=</span> <span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">citizens</span><span style="color: #d0d0d0">[</span><span style="color: #40ffff">$child</span><span style="color: #d0d0d0">]-&gt;</span><span style="color: #bbbbbb">notes</span><span style="color: #d0d0d0">.</span><span style="color: #40ffff">$note</span><span style="color: #d0d0d0">.</span><span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">citizens</span><span style="color: #d0d0d0">[</span><span style="color: #40ffff">$child</span><span style="color: #d0d0d0">]-&gt;</span><span style="color: #bbbbbb">age</span><span style="color: #d0d0d0">.</span><span style="color: #ed9d13">&quot;\n&quot;</span><span style="color: #d0d0d0">;</span>
			<span style="color: #d0d0d0">}</span>
		<span style="color: #d0d0d0">}</span>
	<span style="color: #d0d0d0">}</span> <span style="color: #6ab825; font-weight: bold">else</span> <span style="color: #d0d0d0">{</span>
		<span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">age</span> <span style="color: #d0d0d0">+=</span> <span style="color: #3677a9">1</span><span style="color: #d0d0d0">;</span> 
		<span style="color: #6ab825; font-weight: bold">if</span> <span style="color: #d0d0d0">(</span><span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">age</span> <span style="color: #d0d0d0">&gt;=</span> <span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">race</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">oldAge</span> <span style="color: #d0d0d0">&amp;&amp;</span> <span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">age</span><span style="color: #d0d0d0">-</span><span style="color: #3677a9">1</span> <span style="color: #d0d0d0">&lt;</span> <span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">race</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">oldAge</span><span style="color: #d0d0d0">)</span> <span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">racialBalance</span><span style="color: #d0d0d0">[</span><span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">race</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">name</span><span style="color: #d0d0d0">]--;</span>
	<span style="color: #d0d0d0">}</span>
<span style="color: #d0d0d0">}</span>


<span style="color: #6ab825; font-weight: bold">function</span> <span style="color: #447fcf">ageRegion</span><span style="color: #d0d0d0">(</span><span style="color: #40ffff">$years</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">{</span>
	<span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">getCitizens</span><span style="color: #d0d0d0">(</span><span style="color: #24909d">json_decode</span><span style="color: #d0d0d0">(</span><span style="color: #ed9d13">&#39;{&quot;alive&quot;:1,&quot;excluded&quot;:0}&#39;</span><span style="color: #d0d0d0">));</span>
	<span style="color: #6ab825; font-weight: bold">for</span><span style="color: #d0d0d0">(</span><span style="color: #40ffff">$y</span><span style="color: #d0d0d0">=</span><span style="color: #3677a9">0</span><span style="color: #d0d0d0">;</span><span style="color: #40ffff">$y</span><span style="color: #d0d0d0">&lt;</span><span style="color: #40ffff">$years</span><span style="color: #d0d0d0">;</span><span style="color: #40ffff">$y</span><span style="color: #d0d0d0">++)</span> <span style="color: #d0d0d0">{</span>
		<span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">yearlyBirths</span><span style="color: #d0d0d0">=</span><span style="color: #3677a9">0</span><span style="color: #d0d0d0">;</span>
		<span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">region</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">epoch</span><span style="color: #d0d0d0">++;</span>
		<span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">wives</span><span style="color: #d0d0d0">=[];</span>
		<span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">fathers</span><span style="color: #d0d0d0">=[];</span>
		<span style="color: #6ab825; font-weight: bold">foreach</span><span style="color: #d0d0d0">(</span><span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">citizens</span> <span style="color: #6ab825; font-weight: bold">as</span> <span style="color: #d0d0d0">&amp;</span><span style="color: #40ffff">$k</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">{</span>
			<span style="color: #6ab825; font-weight: bold">if</span> <span style="color: #d0d0d0">(</span><span style="color: #40ffff">$k</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">gender</span> <span style="color: #d0d0d0">==</span> <span style="color: #ed9d13">&#39;female&#39;</span>
			<span style="color: #d0d0d0">&amp;&amp;</span> <span style="color: #40ffff">$k</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">alive</span> <span style="color: #d0d0d0">==</span> <span style="color: #3677a9">1</span>
			<span style="color: #d0d0d0">&amp;&amp;</span> <span style="color: #d0d0d0">(!</span><span style="color: #40ffff">$k</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">married</span> <span style="color: #d0d0d0">||</span> <span style="color: #40ffff">$k</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">married</span> <span style="color: #d0d0d0">==</span> <span style="color: #6ab825; font-weight: bold">null</span> <span style="color: #d0d0d0">||</span> <span style="color: #d0d0d0">mt_rand(</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">,</span><span style="color: #3677a9">50</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">==</span> <span style="color: #3677a9">1</span><span style="color: #d0d0d0">))</span> <span style="color: #d0d0d0">{</span>
				<span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">wives</span><span style="color: #d0d0d0">[</span><span style="color: #40ffff">$k</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">id</span><span style="color: #d0d0d0">]=&amp;</span><span style="color: #40ffff">$k</span><span style="color: #d0d0d0">;</span>
			<span style="color: #d0d0d0">}</span>
			<span style="color: #6ab825; font-weight: bold">if</span> <span style="color: #d0d0d0">(</span><span style="color: #40ffff">$k</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">gender</span> <span style="color: #d0d0d0">==</span> <span style="color: #ed9d13">&#39;male&#39;</span>
			<span style="color: #d0d0d0">&amp;&amp;</span> <span style="color: #40ffff">$k</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">alive</span> <span style="color: #d0d0d0">==</span> <span style="color: #3677a9">1</span>
			<span style="color: #d0d0d0">&amp;&amp;</span> <span style="color: #d0d0d0">(</span><span style="color: #40ffff">$k</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">married</span> <span style="color: #d0d0d0">||</span> <span style="color: #d0d0d0">mt_rand(</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">,</span><span style="color: #3677a9">20</span><span style="color: #d0d0d0">)==</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">))</span> <span style="color: #d0d0d0">{</span>
				<span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">fathers</span><span style="color: #d0d0d0">[</span><span style="color: #40ffff">$k</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">id</span><span style="color: #d0d0d0">]=&amp;</span><span style="color: #40ffff">$k</span><span style="color: #d0d0d0">;</span>
			<span style="color: #d0d0d0">}</span>
		<span style="color: #d0d0d0">}</span>

		<span style="color: #6ab825; font-weight: bold">foreach</span><span style="color: #d0d0d0">(</span><span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">citizens</span> <span style="color: #6ab825; font-weight: bold">as</span> <span style="color: #d0d0d0">&amp;</span><span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">{</span>
			<span style="color: #40ffff">$spliceDead</span><span style="color: #d0d0d0">=[];</span>
			<span style="color: #6ab825; font-weight: bold">if</span> <span style="color: #d0d0d0">(</span><span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">alive</span> <span style="color: #d0d0d0">==</span> <span style="color: #3677a9">0</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">{</span>
				<span style="color: #6ab825; font-weight: bold">continue</span><span style="color: #d0d0d0">;</span>
			<span style="color: #d0d0d0">}</span>
			<span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">deathCheck</span><span style="color: #d0d0d0">(</span><span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">);</span>  
			<span style="color: #6ab825; font-weight: bold">if</span> <span style="color: #d0d0d0">(</span><span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">alive</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">{</span>
				<span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">weddingBells</span><span style="color: #d0d0d0">(</span><span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">);</span>  
				<span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">newChild</span><span style="color: #d0d0d0">(</span><span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">);</span> 
				<span style="color: #6ab825; font-weight: bold">if</span> <span style="color: #d0d0d0">(</span><span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">alive</span> <span style="color: #d0d0d0">&amp;&amp;</span> <span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">age</span><span style="color: #d0d0d0">&gt;</span><span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">race</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">adulthood</span><span style="color: #d0d0d0">/</span><span style="color: #3677a9">2</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">{</span>
					<span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">ratRace</span><span style="color: #d0d0d0">(</span><span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">);</span>
				<span style="color: #d0d0d0">}</span>
			<span style="color: #d0d0d0">}</span>
		<span style="color: #d0d0d0">}</span>
	<span style="color: #d0d0d0">}</span>
	<span style="color: #40ffff">$query</span>  <span style="color: #d0d0d0">=</span> <span style="color: #ed9d13">&quot;DELETE citizen FROM citizen </span>
<span style="color: #ed9d13">		JOIN (SELECT MAX(generation) as gen, race FROM gm_master_tools.citizen </span>
<span style="color: #ed9d13">		WHERE alive = 0 AND account = $this-&gt;account AND region = {</span><span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">region</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">id</span><span style="color: #ed9d13">} group by race) as gMin </span>
<span style="color: #ed9d13">		on citizen.race = gMin.race </span>
<span style="color: #ed9d13">		WHERE alive = 0 </span>
<span style="color: #ed9d13">		AND account = $this-&gt;account </span>
<span style="color: #ed9d13">		AND region = {</span><span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">region</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">id</span><span style="color: #ed9d13">} </span>
<span style="color: #ed9d13">		AND generation &lt; gMin.gen-10&quot;</span><span style="color: #d0d0d0">;</span>
	<span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">mysqli</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">query</span><span style="color: #d0d0d0">(</span><span style="color: #40ffff">$query</span><span style="color: #d0d0d0">);</span>

	<span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">sqlArray</span><span style="color: #d0d0d0">=[];</span>
	<span style="color: #6ab825; font-weight: bold">foreach</span><span style="color: #d0d0d0">(</span><span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">citizens</span> <span style="color: #6ab825; font-weight: bold">as</span> <span style="color: #40ffff">$citizen</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">{</span>
	 	<span style="color: #6ab825; font-weight: bold">if</span> <span style="color: #d0d0d0">(</span><span style="color: #24909d">is_object</span><span style="color: #d0d0d0">(</span><span style="color: #40ffff">$citizen</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">spouse</span><span style="color: #d0d0d0">))</span> <span style="color: #d0d0d0">{</span>
	 		<span style="color: #40ffff">$tmpSpouse</span> <span style="color: #d0d0d0">=</span> <span style="color: #40ffff">$citizen</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">spouse</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">id</span><span style="color: #d0d0d0">;</span>
	 		<span style="color: #24909d">unset</span><span style="color: #d0d0d0">(</span><span style="color: #40ffff">$citizen</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">spouse</span><span style="color: #d0d0d0">);</span>
	 		<span style="color: #40ffff">$citizen</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">spouse</span> <span style="color: #d0d0d0">=</span> <span style="color: #40ffff">$tmpSpouse</span><span style="color: #d0d0d0">;</span>
	 	<span style="color: #d0d0d0">}</span>
	 	<span style="color: #40ffff">$citizen</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">race</span> <span style="color: #d0d0d0">=</span> <span style="color: #40ffff">$citizen</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">race</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">id</span><span style="color: #d0d0d0">;</span>
	 	<span style="color: #40ffff">$citizen</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">features</span> <span style="color: #d0d0d0">=</span> <span style="color: #24909d">json_encode</span><span style="color: #d0d0d0">(</span><span style="color: #40ffff">$citizen</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">features</span><span style="color: #d0d0d0">);</span>
	 	<span style="color: #40ffff">$citizen</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">children</span> <span style="color: #d0d0d0">=</span> <span style="color: #24909d">implode</span><span style="color: #d0d0d0">(</span><span style="color: #ed9d13">&quot;,&quot;</span><span style="color: #d0d0d0">,</span><span style="color: #40ffff">$citizen</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">children</span><span style="color: #d0d0d0">);</span>
	 	<span style="color: #40ffff">$query</span> <span style="color: #d0d0d0">=</span> <span style="color: #ed9d13">&quot;REPLACE INTO citizen SET &quot;</span><span style="color: #d0d0d0">;</span>
 		<span style="color: #6ab825; font-weight: bold">foreach</span><span style="color: #d0d0d0">(</span><span style="color: #40ffff">$citizen</span> <span style="color: #6ab825; font-weight: bold">as</span> <span style="color: #40ffff">$key</span><span style="color: #d0d0d0">=&gt;</span><span style="color: #40ffff">$value</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">{</span>
 			<span style="color: #6ab825; font-weight: bold">if</span> <span style="color: #d0d0d0">(</span><span style="color: #40ffff">$value</span> <span style="color: #d0d0d0">===</span> <span style="color: #6ab825; font-weight: bold">NULL</span> <span style="color: #d0d0d0">)</span> <span style="color: #40ffff">$query</span> <span style="color: #d0d0d0">=</span> <span style="color: #40ffff">$query</span><span style="color: #d0d0d0">;</span>
 				<span style="color: #6ab825; font-weight: bold">elseif</span> <span style="color: #d0d0d0">(</span><span style="color: #24909d">is_numeric</span><span style="color: #d0d0d0">(</span><span style="color: #40ffff">$value</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">||</span> <span style="color: #40ffff">$value</span> <span style="color: #d0d0d0">==</span> <span style="color: #ed9d13">&quot;NULL&quot;</span><span style="color: #d0d0d0">)</span> <span style="color: #40ffff">$query</span> <span style="color: #d0d0d0">.=</span> <span style="color: #40ffff">$key</span><span style="color: #d0d0d0">.</span><span style="color: #ed9d13">&quot; = &quot;</span><span style="color: #d0d0d0">.</span><span style="color: #40ffff">$value</span><span style="color: #d0d0d0">.</span><span style="color: #ed9d13">&quot;,&quot;</span><span style="color: #d0d0d0">;</span>
 					<span style="color: #6ab825; font-weight: bold">else</span> <span style="color: #40ffff">$query</span> <span style="color: #d0d0d0">.=</span> <span style="color: #40ffff">$key</span><span style="color: #d0d0d0">.</span><span style="color: #ed9d13">&quot; = &#39;&quot;</span><span style="color: #d0d0d0">.</span><span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">mysqli</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">real_escape_string</span><span style="color: #d0d0d0">(</span><span style="color: #40ffff">$value</span><span style="color: #d0d0d0">).</span><span style="color: #ed9d13">&quot;&#39;,&quot;</span><span style="color: #d0d0d0">;</span>
 		<span style="color: #d0d0d0">}</span>
 		<span style="color: #40ffff">$query</span> <span style="color: #d0d0d0">=</span> <span style="color: #24909d">rtrim</span><span style="color: #d0d0d0">(</span><span style="color: #40ffff">$query</span><span style="color: #d0d0d0">,</span> <span style="color: #ed9d13">&#39;,&#39;</span><span style="color: #d0d0d0">);</span>
 		<span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">sqlArray</span><span style="color: #d0d0d0">[]=</span><span style="color: #40ffff">$query</span><span style="color: #d0d0d0">;</span>
	<span style="color: #d0d0d0">}</span>
	<span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">multiQuery</span><span style="color: #d0d0d0">(</span><span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">sqlArray</span><span style="color: #d0d0d0">);</span>
	<span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">region</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">stats</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">[];</span>
	<span style="color: #40ffff">$query</span> <span style="color: #d0d0d0">=</span> <span style="color: #ed9d13">&quot;SELECT ROUND(AVG(age)) as avgAge, count(firstName) as livingCount, race.name </span>
<span style="color: #ed9d13">	FROM citizen JOIN race on citizen.race = race.id </span>
<span style="color: #ed9d13">	WHERE alive = 1 </span>
<span style="color: #ed9d13">	AND citizen.account = $this-&gt;account </span>
<span style="color: #ed9d13">	AND citizen.immortal = 0 </span>
<span style="color: #ed9d13">	AND region = {</span><span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">region</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">id</span><span style="color: #ed9d13">} group by race&quot;</span><span style="color: #d0d0d0">;</span>
	<span style="color: #6ab825; font-weight: bold">if</span> <span style="color: #d0d0d0">(</span><span style="color: #40ffff">$result</span> <span style="color: #d0d0d0">=</span> <span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">mysqli</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">query</span><span style="color: #d0d0d0">(</span><span style="color: #40ffff">$query</span><span style="color: #d0d0d0">))</span> <span style="color: #d0d0d0">{</span>
		<span style="color: #6ab825; font-weight: bold">while</span><span style="color: #d0d0d0">(</span><span style="color: #40ffff">$row</span><span style="color: #d0d0d0">=</span><span style="color: #40ffff">$result</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">fetch_object</span><span style="color: #d0d0d0">())</span> <span style="color: #d0d0d0">{</span>
			<span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">region</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">stats</span><span style="color: #d0d0d0">[]</span> <span style="color: #d0d0d0">=</span> <span style="color: #40ffff">$row</span><span style="color: #d0d0d0">;</span>
			<span style="color: #d0d0d0">}</span>
			<span style="color: #40ffff">$result</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">close</span><span style="color: #d0d0d0">();</span>
		<span style="color: #d0d0d0">}</span>
	<span style="color: #40ffff">$return</span> <span style="color: #d0d0d0">=</span> <span style="color: #24909d">json_encode</span><span style="color: #d0d0d0">(</span><span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">region</span><span style="color: #d0d0d0">);</span>
	<span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">region</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">stats</span> <span style="color: #d0d0d0">=</span> <span style="color: #24909d">json_encode</span><span style="color: #d0d0d0">(</span><span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">region</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">stats</span><span style="color: #d0d0d0">);</span>
	<span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">region</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">racialBalance</span> <span style="color: #d0d0d0">=</span> <span style="color: #24909d">json_encode</span><span style="color: #d0d0d0">(</span><span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">region</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">racialBalance</span><span style="color: #d0d0d0">);</span>
	<span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">region</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">profBalance</span> <span style="color: #d0d0d0">=</span> <span style="color: #24909d">json_encode</span><span style="color: #d0d0d0">(</span><span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">region</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">profBalance</span><span style="color: #d0d0d0">);</span>
	<span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">upsertRecord</span><span style="color: #d0d0d0">(</span><span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">region</span><span style="color: #d0d0d0">,</span><span style="color: #ed9d13">&quot;region&quot;</span><span style="color: #d0d0d0">);</span>
	  
	<span style="color: #6ab825; font-weight: bold">return</span> <span style="color: #40ffff">$return</span><span style="color: #d0d0d0">;</span>
<span style="color: #d0d0d0">}</span>

<span style="color: #6ab825; font-weight: bold">private</span> <span style="color: #6ab825; font-weight: bold">function</span> <span style="color: #447fcf">ratRace</span><span style="color: #d0d0d0">(&amp;</span><span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">{</span>

	<span style="color: #6ab825; font-weight: bold">if</span> <span style="color: #d0d0d0">(</span><span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">profession</span> <span style="color: #d0d0d0">!=</span> <span style="color: #ed9d13">&quot;&quot;</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">{</span>
		<span style="color: #6ab825; font-weight: bold">if</span> <span style="color: #d0d0d0">(</span><span style="color: #24909d">array_key_exists</span><span style="color: #d0d0d0">(</span><span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">profession</span><span style="color: #d0d0d0">,</span> <span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">professions</span><span style="color: #d0d0d0">))</span> <span style="color: #d0d0d0">{</span>
			<span style="color: #40ffff">$maxAge</span> <span style="color: #d0d0d0">=</span> <span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">professions</span><span style="color: #d0d0d0">[</span><span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">profession</span><span style="color: #d0d0d0">]-&gt;</span><span style="color: #bbbbbb">maxAge</span><span style="color: #d0d0d0">;</span>
			<span style="color: #6ab825; font-weight: bold">if</span> <span style="color: #d0d0d0">(</span><span style="color: #40ffff">$maxAge</span> <span style="color: #d0d0d0">==</span> <span style="color: #ed9d13">&quot;none&quot;</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">{</span>
				<span style="color: #40ffff">$maxAge</span><span style="color: #d0d0d0">=</span><span style="color: #3677a9">9999</span><span style="color: #d0d0d0">;</span>
			<span style="color: #d0d0d0">}</span> <span style="color: #6ab825; font-weight: bold">else</span> <span style="color: #d0d0d0">{</span>
				<span style="color: #40ffff">$maxAge</span> <span style="color: #d0d0d0">=</span> <span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">race</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #40ffff">$maxAge</span><span style="color: #d0d0d0">;</span>
			<span style="color: #d0d0d0">}</span>
			<span style="color: #6ab825; font-weight: bold">if</span> <span style="color: #d0d0d0">(</span><span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">age</span> <span style="color: #d0d0d0">&gt;=</span> <span style="color: #40ffff">$maxAge</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">{</span>
				<span style="color: #6ab825; font-weight: bold">if</span> <span style="color: #d0d0d0">(mt_rand(</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">,</span><span style="color: #3677a9">12</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">==</span> <span style="color: #3677a9">1</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">{</span>
					<span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">notes</span><span style="color: #d0d0d0">.=</span><span style="color: #ed9d13">&quot;Retired at &quot;</span><span style="color: #d0d0d0">.</span><span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">age</span><span style="color: #d0d0d0">.</span><span style="color: #ed9d13">&quot;.\n&quot;</span><span style="color: #d0d0d0">;</span>
					<span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">profession</span> <span style="color: #d0d0d0">=</span> <span style="color: #ed9d13">&quot;Retired &quot;</span><span style="color: #d0d0d0">.</span><span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">profession</span><span style="color: #d0d0d0">;</span>
				<span style="color: #d0d0d0">}</span>
			<span style="color: #d0d0d0">}</span>
		<span style="color: #d0d0d0">}</span>
		<span style="color: #6ab825; font-weight: bold">return</span><span style="color: #d0d0d0">;</span>
	<span style="color: #d0d0d0">}</span>
	<span style="color: #40ffff">$getAJob</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">10</span><span style="color: #d0d0d0">;</span>
	<span style="color: #6ab825; font-weight: bold">if</span> <span style="color: #d0d0d0">(</span><span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">age</span> <span style="color: #d0d0d0">&lt;</span> <span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">race</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">adulthood</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">{</span>
		<span style="color: #40ffff">$getAJob</span> <span style="color: #d0d0d0">=</span> <span style="color: #3677a9">30</span><span style="color: #d0d0d0">;</span>
	<span style="color: #d0d0d0">}</span>
	<span style="color: #6ab825; font-weight: bold">if</span> <span style="color: #d0d0d0">(mt_rand(</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">,</span><span style="color: #40ffff">$getAJob</span><span style="color: #d0d0d0">)==</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">{</span>
		<span style="color: #40ffff">$profBalance</span> <span style="color: #d0d0d0">=</span> <span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">region</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">profBalance</span><span style="color: #d0d0d0">;</span>
		<span style="color: #40ffff">$balanceTotal</span><span style="color: #d0d0d0">=</span><span style="color: #3677a9">0</span><span style="color: #d0d0d0">;</span>
		<span style="color: #40ffff">$profList</span><span style="color: #d0d0d0">=[];</span>
		<span style="color: #6ab825; font-weight: bold">foreach</span><span style="color: #d0d0d0">(</span><span style="color: #40ffff">$profBalance</span> <span style="color: #6ab825; font-weight: bold">as</span> <span style="color: #40ffff">$prof</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">{</span>
			<span style="color: #40ffff">$tmpValue</span> <span style="color: #d0d0d0">=</span> <span style="color: #40ffff">$prof</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">value</span><span style="color: #d0d0d0">;</span>
			<span style="color: #6ab825; font-weight: bold">if</span> <span style="color: #d0d0d0">(@</span><span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">citizens</span><span style="color: #d0d0d0">[</span><span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">father</span><span style="color: #d0d0d0">]-&gt;</span><span style="color: #bbbbbb">profession</span> <span style="color: #d0d0d0">==</span> <span style="color: #40ffff">$prof</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">prof</span>
			<span style="color: #d0d0d0">||</span> <span style="color: #d0d0d0">@</span><span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">citizens</span><span style="color: #d0d0d0">[</span><span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">father</span><span style="color: #d0d0d0">]-&gt;</span><span style="color: #bbbbbb">profession</span> <span style="color: #d0d0d0">==</span> <span style="color: #ed9d13">&quot;Retired &quot;</span><span style="color: #d0d0d0">.</span><span style="color: #40ffff">$prof</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">prof</span>
			<span style="color: #d0d0d0">||</span> <span style="color: #d0d0d0">@</span><span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">citizens</span><span style="color: #d0d0d0">[</span><span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">mother</span><span style="color: #d0d0d0">]-&gt;</span><span style="color: #bbbbbb">profession</span> <span style="color: #d0d0d0">==</span> <span style="color: #40ffff">$prof</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">prof</span> 
			<span style="color: #d0d0d0">||</span> <span style="color: #d0d0d0">@</span><span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">citizens</span><span style="color: #d0d0d0">[</span><span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">mother</span><span style="color: #d0d0d0">]-&gt;</span><span style="color: #bbbbbb">profession</span> <span style="color: #d0d0d0">==</span> <span style="color: #ed9d13">&quot;Retired &quot;</span><span style="color: #d0d0d0">.</span><span style="color: #40ffff">$prof</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">prof</span> <span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">{</span>
				<span style="color: #40ffff">$tmpValue</span> <span style="color: #d0d0d0">=</span> <span style="color: #40ffff">$prof</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">value</span><span style="color: #d0d0d0">*</span><span style="color: #3677a9">3</span><span style="color: #d0d0d0">;</span>
			<span style="color: #d0d0d0">}</span>
			<span style="color: #40ffff">$balanceTotal</span> <span style="color: #d0d0d0">+=</span> <span style="color: #40ffff">$tmpValue</span><span style="color: #d0d0d0">;</span>
			<span style="color: #40ffff">$profList</span><span style="color: #d0d0d0">[]=</span><span style="color: #6ab825; font-weight: bold">array</span><span style="color: #d0d0d0">(</span><span style="color: #40ffff">$prof</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">prof</span><span style="color: #d0d0d0">,</span><span style="color: #40ffff">$tmpValue</span><span style="color: #d0d0d0">);</span>
		<span style="color: #d0d0d0">}</span>
		<span style="color: #40ffff">$randResult</span> <span style="color: #d0d0d0">=</span> <span style="color: #d0d0d0">mt_rand(</span><span style="color: #3677a9">0</span><span style="color: #d0d0d0">,</span><span style="color: #40ffff">$balanceTotal</span><span style="color: #d0d0d0">);</span>
		<span style="color: #6ab825; font-weight: bold">foreach</span><span style="color: #d0d0d0">(</span><span style="color: #40ffff">$profList</span> <span style="color: #6ab825; font-weight: bold">as</span> <span style="color: #40ffff">$prof</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">{</span>
			<span style="color: #40ffff">$balanceTotal</span> <span style="color: #d0d0d0">-=</span> <span style="color: #40ffff">$prof</span><span style="color: #d0d0d0">[</span><span style="color: #3677a9">1</span><span style="color: #d0d0d0">];</span>
			<span style="color: #40ffff">$minAge</span> <span style="color: #d0d0d0">=</span> <span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">professions</span><span style="color: #d0d0d0">[</span><span style="color: #40ffff">$prof</span><span style="color: #d0d0d0">[</span><span style="color: #3677a9">0</span><span style="color: #d0d0d0">]]-&gt;</span><span style="color: #bbbbbb">minAge</span><span style="color: #d0d0d0">;</span>
			<span style="color: #6ab825; font-weight: bold">if</span> <span style="color: #d0d0d0">(</span><span style="color: #40ffff">$minAge</span> <span style="color: #d0d0d0">==</span> <span style="color: #ed9d13">&quot;none&quot;</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">{</span>
				<span style="color: #40ffff">$minAge</span><span style="color: #d0d0d0">=</span><span style="color: #3677a9">0</span><span style="color: #d0d0d0">;</span>
			<span style="color: #d0d0d0">}</span> <span style="color: #6ab825; font-weight: bold">else</span> <span style="color: #d0d0d0">{</span>
				<span style="color: #40ffff">$minAge</span> <span style="color: #d0d0d0">=</span> <span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">race</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #40ffff">$minAge</span><span style="color: #d0d0d0">;</span>
			<span style="color: #d0d0d0">}</span>
			<span style="color: #40ffff">$maxAge</span> <span style="color: #d0d0d0">=</span> <span style="color: #40ffff">$this</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">professions</span><span style="color: #d0d0d0">[</span><span style="color: #40ffff">$prof</span><span style="color: #d0d0d0">[</span><span style="color: #3677a9">0</span><span style="color: #d0d0d0">]]-&gt;</span><span style="color: #bbbbbb">maxAge</span><span style="color: #d0d0d0">;</span>
			<span style="color: #6ab825; font-weight: bold">if</span> <span style="color: #d0d0d0">(</span><span style="color: #40ffff">$maxAge</span> <span style="color: #d0d0d0">==</span> <span style="color: #ed9d13">&quot;none&quot;</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">{</span>
				<span style="color: #40ffff">$maxAge</span><span style="color: #d0d0d0">=</span><span style="color: #3677a9">9999</span><span style="color: #d0d0d0">;</span>
			<span style="color: #d0d0d0">}</span> <span style="color: #6ab825; font-weight: bold">else</span> <span style="color: #d0d0d0">{</span>
				<span style="color: #40ffff">$maxAge</span> <span style="color: #d0d0d0">=</span> <span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">race</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #40ffff">$maxAge</span><span style="color: #d0d0d0">;</span>
			<span style="color: #d0d0d0">}</span>

			<span style="color: #6ab825; font-weight: bold">if</span> <span style="color: #d0d0d0">(</span><span style="color: #40ffff">$randResult</span><span style="color: #d0d0d0">&gt;=</span><span style="color: #40ffff">$balanceTotal</span> <span style="color: #d0d0d0">&amp;&amp;</span> <span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">age</span> <span style="color: #d0d0d0">&gt;=</span> <span style="color: #40ffff">$minAge</span> <span style="color: #d0d0d0">&amp;&amp;</span> <span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">age</span> <span style="color: #d0d0d0">&lt;</span> <span style="color: #40ffff">$maxAge</span><span style="color: #d0d0d0">)</span> <span style="color: #d0d0d0">{</span>
				<span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">notes</span><span style="color: #d0d0d0">.=</span><span style="color: #ed9d13">&quot;Became a/an $prof[0] at &quot;</span><span style="color: #d0d0d0">.</span><span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">age</span><span style="color: #d0d0d0">.</span><span style="color: #ed9d13">&quot;\n&quot;</span><span style="color: #d0d0d0">;</span>
				<span style="color: #40ffff">$cc</span><span style="color: #d0d0d0">-&gt;</span><span style="color: #bbbbbb">profession</span> <span style="color: #d0d0d0">=</span> <span style="color: #40ffff">$prof</span><span style="color: #d0d0d0">[</span><span style="color: #3677a9">0</span><span style="color: #d0d0d0">];</span>
				<span style="color: #6ab825; font-weight: bold">return</span><span style="color: #d0d0d0">;</span>
			<span style="color: #d0d0d0">}</span>
		<span style="color: #d0d0d0">}</span>
	<span style="color: #d0d0d0">}</span>
<span style="color: #d0d0d0">}</span>
</pre></div>
